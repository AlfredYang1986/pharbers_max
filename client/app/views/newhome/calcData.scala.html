@(auth: String)

@layout("Max | Home") {
    <link href="@routes.Assets.versioned("css/style.default.css")" rel="stylesheet">
    <script src="@routes.Assets.versioned("eachars3.0/echarts.js")"></script>
    <body>
        <div class="layui-tab" lay-filter="step">
            <ul class="layui-tab-title">
                <li class="layui-this">CPA文件上传</li>
                <li>GYCX文件上传</li>
                <li>样本检查</li>
                <li>结果检查</li>
            </ul>
            <div class="layui-tab-content">
                <div class="layui-tab-item">
                @upload.cpaUpload()
                </div>
                <div class="layui-tab-item">
                @upload.gycxUpload()
                </div>
                <div class="layui-tab-item">
                @sample.sampleCheck()
                </div>
                <div class="layui-tab-item layui-show">
                @result.resultCheck()
                </div>
            </div>
        </div>
    </body>
} {
    <script type="text/javascript" >
            $(function () {
                $('li[pharbers-filter="calc"]').addClass("layui-this")
            })
    </script>
    <script>
            layui.use('element', function () {
                var element = layui.element;
                element.on('tab(step)', function (elem) {
                    console.log(elem);
                });
            });

            layui.use('upload', function () {
                var upload = layui.upload;
                var cpa_lst = $('#cpa_lst');
                upload.render({
                    elem: '#select_cpa_btn',
                    url: '/api/upload/',
                    auto: false, //选择文件后不自动上传
//                multiple: true,
                    accept: 'file',
                    exts: 'xlsx',
                    bindAction: '#upload_cap_btn',
                    choose: function (obj) {
                        if (cpa_lst.html() !== "") {
                            layer.open({
                                title: '提示',
                                content: '只能上传一个CPA数据源'
                            });
                        } else {
                            var files = obj.pushFile();
                            obj.preview(function (index, file, result) {
                                var tr = $(['<tr id="upload-' + index + '">'
                                    , '<td>' + file.name + '</td>'
                                    , '<td>' + (file.size / 1024 / 1024).toFixed(1) + 'MB</td>'
                                    , '<td>等待上传</td>'
                                    , '<td>'
                                    , '<button class="layui-btn layui-btn-mini demo-reload layui-hide">重传</button>'
                                    , '<button class="layui-btn layui-btn-mini layui-btn-danger demo-delete">删除</button>'
                                    , '</td>'
                                    , '</tr>'].join(''));

                                tr.find('.demo-reload').on('click', function () {
                                    obj.upload(index, file);
                                });

                                tr.find('.demo-delete').on('click', function () {
                                    delete files[index];
                                    tr.remove();
                                });

                                cpa_lst.append(tr);
                            });
                        }
                    },
                    done: function (res, index, upload) {
                        if (res.code == 0) { //上传成功
                            var tr = cpa_lst.find('tr#upload-' + index);
                            var tds = tr.children();
                            tds.eq(2).html('<span style="color: #5FB878;">上传成功</span>');
                            tds.eq(3).html(''); //清空操作
                            delete files[index]; //删除文件队列已经上传成功的文件
                            return;
                        }
                        this.error(index, upload);
                    },
                    error: function (index, upload) {
                        var tr = cpa_lst.find('tr#upload-' + index);
                        var tds = tr.children();
                        tds.eq(2).html('<span style="color: #FF5722;">上传失败</span>');
                        tds.eq(3).find('.demo-reload').removeClass('layui-hide'); //显示重传
                    }
                });
            });

            layui.use('upload', function () {
                var upload = layui.upload;
                var gycx_lst = $('#gycx_lst');
                upload.render({
                    elem: '#select_gycx_btn',
                    url: '/api/upload/',
                    auto: false, //选择文件后不自动上传
//                multiple: true,
                    accept: 'file',
                    exts: 'xlsx',
                    bindAction: '#upload_gycx_btn',
                    choose: function (obj) {
                        if (gycx_lst.html() !== "") {
                            layer.open({
                                title: '提示',
                                content: '只能上传一个CPA数据源'
                            });
                        } else {
                            var files = obj.pushFile();
                            obj.preview(function (index, file, result) {
                                var tr = $(['<tr id="upload-' + index + '">'
                                    , '<td>' + file.name + '</td>'
                                    , '<td>' + (file.size / 1024 / 1024).toFixed(1) + 'MB</td>'
                                    , '<td>等待上传</td>'
                                    , '<td>'
                                    , '<button class="layui-btn layui-btn-mini demo-reload layui-hide">重传</button>'
                                    , '<button class="layui-btn layui-btn-mini layui-btn-danger demo-delete">删除</button>'
                                    , '</td>'
                                    , '</tr>'].join(''));

                                tr.find('.demo-reload').on('click', function () {
                                    obj.upload(index, file);
                                });

                                tr.find('.demo-delete').on('click', function () {
                                    delete files[index];
                                    tr.remove();
                                });

                                gycx_lst.append(tr);
                            });
                        }
                    },
                    done: function (res, index, upload) {
                        if (res.code == 0) { //上传成功
                            var tr = gycx_lst.find('tr#upload-' + index);
                            var tds = tr.children();
                            tds.eq(2).html('<span style="color: #5FB878;">上传成功</span>');
                            tds.eq(3).html(''); //清空操作
                            delete files[index]; //删除文件队列已经上传成功的文件
                            return;
                        }
                        this.error(index, upload);
                    },
                    error: function (index, upload) {
                        var tr = gycx_lst.find('tr#upload-' + index);
                        var tds = tr.children();
                        tds.eq(2).html('<span style="color: #FF5722;">上传失败</span>');
                        tds.eq(3).find('.demo-reload').removeClass('layui-hide'); //显示重传
                    }
                });
            });
    </script> <!--cpa gycx upload-->
    <script>
            var form = layui.form;
            var sample_market = ["market1", "market2", "market3"];
            var sample_date = ["date1", "date2", "date3"];
            $.each(sample_market, function (i) {
                $('#sample_market').append(new Option(sample_market[i]));
            });
            $.each(sample_date, function (i) {
                $('#sample_date').append(new Option(sample_date[i]));
            });

            $('#Current_Month_HospitalNum').text("912");
            $('#Early_Month_HospitalNum').text("0");
            $('#Last_Year_HospitalNum').text("0");
            $('#Current_Month_ProductNum').text("2331");
            $('#Early_Month_ProductNum').text("0");
            $('#Last_Year_ProductNum').text("0");
            $('#Current_Month_MarketNum').text("1");
            $('#Early_Month_MarketNum').text("0");
            $('#Last_Year_MarketNum').text("0");

    </script> <!-- select box and ###-->
    <script>
            var hospline_chart = echarts.init(document.getElementById('hospline'));
            // 指定图表的配置项和数据
            var option = {
                xAxis: {
                    show: false
                },
                yAxis: {
                    show: false
                },
                series: [{
                    type: 'line',
                    data: [
                        [0, 0],
                        [5, 0],
                        [10, 0],
                        [15, 0],
                        [20, 0],
                        [25, 0],
                        [30, 160000]
                    ]
                }]
            };
            hospline_chart.setOption(option);

            var prodline_chart = echarts.init(document.getElementById('prodline'));
            // 指定图表的配置项和数据
            var option = {
                xAxis: {
                    show: false
                },
                yAxis: {
                    show: false
                },
                series: [{
                    type: 'line',
                    data: [
                        [0, 0],
                        [5, 0],
                        [10, 0],
                        [15, 0],
                        [20, 0],
                        [25, 0],
                        [30, 6]

                    ]
                }]
            };
            prodline_chart.setOption(option);

            var markline_chart = echarts.init(document.getElementById('markline'));
            // 指定图表的配置项和数据
            var option = {
                xAxis: {
                    show: false
                },
                yAxis: {
                    show: false
                },
                series: [{
                    type: 'line',
                    data: [
                        [0, 0],
                        [5, 0],
                        [10, 0],
                        [15, 0],
                        [20, 0],
                        [25, 0],
                        [30, 6]
                    ]
                }]
            };
            markline_chart.setOption(option);
    </script> <!--  row3 three eachars  -->
    <script>
            var sales_chart = echarts.init(document.getElementById('Sales'));
            // 指定图表的配置项和数据
            var option = {
                title: {
                    text: '今年Vs去年(近12月销售额)',
                    left: 'center'
                },
                xAxis: {
                    name: '日期',
                    type: 'category',
                    boundaryGap: false,
                    data: ['201512', '201601', '201602', '201603', '201604', '201605', '201606',
                        '201607', '201608', '201609', '201610', '201611']
                },
                yAxis: {
                    name: '销售额(万)',
                    type: 'value'
                },
                series: [{
                    type: 'line',
                    data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5555]
                }]
            };
            sales_chart.setOption(option);
    </script> <!--  row4 Sales eachars  -->
    <script>
            var units_chart = echarts.init(document.getElementById('Units'));
            // 指定图表的配置项和数据
            var option = {
                title: {
                    text: '今年Vs去年(近12月销售量)',
                    left: 'center'
                },
                xAxis: {
                    name: '日期',
                    type: 'category',
                    boundaryGap: false,
                    data: ['201512', '201601', '201602', '201603', '201604', '201605', '201606',
                        '201607', '201608', '201609', '201610', '201611']
                },
                yAxis: {
                    name: '销售量(万)',
                    type: 'value'
                },
                series: [{
                    type: 'line',
                    data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2555]
                }]
            };
            units_chart.setOption(option);
    </script> <!--  row5 Units eachars  -->
    <script>
            layui.use('table', function () {
                var table = layui.table;

                table.render({
                    elem: '#semple_table',
                    cols: [[
                        {align: 'center', title: '样本医院检查结果', colspan: 6}
                    ], [
                        {field: 'id', title: '序号', align: 'center', sort: true, rowspan: 1, width:100},
                        {field: 'hosp_name', title: '医院名称', align: 'center', sort: true, rowspan: 2, width:200},
                        {field: 'provinces', title: '省份', align: 'center', sort: true, rowspan: 1, width:200},
                        {field: 'city', title: '城市', align: 'center', sort: true, rowspan: 1, width:200},
                        {field: 'level', title: '城市级别', align: 'center', sort: true, rowspan: 1, width:200}
                    ]],
                    data: [
                        {"id": "a1", "hosp_name": "a2", "provinces": "a3", "city": "a4", "level": "a5"},
                        {"id": "b1", "hosp_name": "b2", "provinces": "b3", "city": "b4", "level": "b5"},
                        {"id": "c1", "hosp_name": "c2", "provinces": "c3", "city": "e4", "level": "c5"},
                        {"id": "d1", "hosp_name": "d2", "provinces": "d3", "city": "d4", "level": "d5"},
                        {'id': "e1", 'hosp_name': "e2", 'provinces': "e3", 'city': "e4", 'level': "e5"},
                        {'id': "a2", "hosp_name": "b2", "provinces": "a3", "city": "a4", "level": "a5"},
                        {'id': "a3", "hosp_name": "a2", "provinces": "a3", "city": "a4", "level": "a5"},
                        {'id': "a4", "hosp_name": "a2", "provinces": "a3", "city": "a4", "level": "a5"},
                        {"id": "a5", "hosp_name": "a2", "provinces": "a3", "city": "a4", "level": "a5"}
                    ],
                    page: true , //是否显示分页
                    limits: [5, 7, 10],
                    limit: 5 //每页默认显示的数量
                });
            });
    </script> <!--  row6 table  -->
    <script>
            var result_check_market = ["market1", "market2", "market3"];
            var result_check_date = ["date1", "date2", "date3"];
            $.each(result_check_market, function (i) {
                $('#result_check_market').append(new Option(result_check_market[i]));
            });
            $.each(result_check_date, function (i) {
                $('#result_check_date').append(new Option(result_check_date[i]));
            });
    </script> <!-- page 4 select box-->
    <script>
            var bar1_chart = echarts.init(document.getElementById('bar1'));
            // 指定图表的配置项和数据
            var option = {
                xAxis: {
                    name: '日期',
                    data: ['201512', '201601', '201602', '201603', '201604', '201605', '201606',
                        '201607', '201608', '201609', '201610', '201611']
                },
                yAxis: {
                    name: '销售额(万)',
                    type: 'value'
                },
                series: [{
                    type: 'bar',
                    data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 8555]
                }]
            };
            // 使用刚指定的配置项和数据显示图表。
            bar1_chart.setOption(option);


            var bar2_chart = echarts.init(document.getElementById('bar2'));
            // 指定图表的配置项和数据
            var option = {
                xAxis: {
                    name: '城市',
                    data: ['北京市', '上海市', '成都市', '广州市', '南京市', '合肥市',
                        '北京市', '上海市', '成都市', '广州市', '南京市', '合肥市']
                },
                yAxis: {
                    name: '销售额(万)',
                    type: 'value'
                },
                series: [{
                    type: 'bar',
                    data: [1350, 750, 400, 390, 380, 250, 0, 0, 0, 0, 0, 0, 0]
                }]
            };
            bar2_chart.setOption(option);


            var bar3_chart = echarts.init(document.getElementById('bar3'));
            // 指定图表的配置项和数据
            var option = {
                title: {
                    text: '今年Vs去年(近12月销售额)',
                    left: 'center'
                },
                xAxis: {
                    name: '日期',
                    type: 'category',
                    boundaryGap: false,
                    data: ['201512', '201601', '201602', '201603', '201604', '201605', '201606',
                        '201607', '201608', '201609', '201610', '201611']
                },
                yAxis: {
                    name: '销售额(万)',
                    type: 'value'
                },
                series: [{
                    type: 'bar',
                    data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5555]
                }]
            };
            bar3_chart.setOption(option);
    </script> <!-- page 4 Sales eachars  -->
}